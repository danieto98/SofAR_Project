<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hands On with SLAM: catkin_ws/src/labeled_slam/src/path_follower.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hands On with SLAM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c9b1b03f6e45e6a48c8e8f7b0f905ad.html">catkin_ws</a></li><li class="navelem"><a class="el" href="dir_7c859f3878cb32062c29919224ce2290.html">src</a></li><li class="navelem"><a class="el" href="dir_f8178057b2491da2b40026c85f853a2c.html">labeled_slam</a></li><li class="navelem"><a class="el" href="dir_2e2b0e85e257096b0270c50a23f8d1ec.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">path_follower.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sstream&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;ros/ros.h&quot;</code><br />
<code>#include &quot;std_msgs/Header.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Point.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Pose.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Twist.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Vector3.h&quot;</code><br />
<code>#include &quot;geometry_msgs/TransformStamped.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Transform.h&quot;</code><br />
<code>#include &lt;tf/transform_listener.h&gt;</code><br />
<code>#include &quot;nav_msgs/Path.h&quot;</code><br />
<code>#include &quot;tf/LinearMath/Transform.h&quot;</code><br />
<code>#include &quot;tf/LinearMath/Matrix3x3.h&quot;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;array&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for path_follower.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="path__follower_8cpp__incl.png" border="0" usemap="#catkin__ws_2src_2labeled__slam_2src_2path__follower_8cpp" alt=""/></div>
</div>
</div>
<p><a href="path__follower_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa9a42b10b0895a8dea5f7a3e53622445"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#aa9a42b10b0895a8dea5f7a3e53622445">path_callback</a> (const nav_msgs::Path::ConstPtr &amp;received_path)</td></tr>
<tr class="separator:aa9a42b10b0895a8dea5f7a3e53622445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6580d4219bb711f9f65ecdc5ae43a7b4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a6580d4219bb711f9f65ecdc5ae43a7b4">proximity_check</a> (geometry_msgs::Point goal, tf::Point current)</td></tr>
<tr class="separator:a6580d4219bb711f9f65ecdc5ae43a7b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a381fc6065d560c219bdf0733ccd3ba13"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a381fc6065d560c219bdf0733ccd3ba13">angle_check</a> (float goal_angle, tfScalar yaw)</td></tr>
<tr class="separator:a381fc6065d560c219bdf0733ccd3ba13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a06bc50440cb7aad0ef28a930499574c5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; geometry_msgs::PoseStamped &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a06bc50440cb7aad0ef28a930499574c5">current_path</a></td></tr>
<tr class="separator:a06bc50440cb7aad0ef28a930499574c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd300c5785c540c1370de4c45066f345"><td class="memItemLeft" align="right" valign="top">std::vector&lt; geometry_msgs::PoseStamped &gt;::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#afd300c5785c540c1370de4c45066f345">it</a></td></tr>
<tr class="separator:afd300c5785c540c1370de4c45066f345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd788339a5b3696b0f6273eda3136fc"><td class="memItemLeft" align="right" valign="top">geometry_msgs::Point&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a1dd788339a5b3696b0f6273eda3136fc">goal_position</a></td></tr>
<tr class="memdesc:a1dd788339a5b3696b0f6273eda3136fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Goal position on map.  <a href="#a1dd788339a5b3696b0f6273eda3136fc">More...</a><br /></td></tr>
<tr class="separator:a1dd788339a5b3696b0f6273eda3136fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbef336bbcb2c1100f1e01e10a7beee6"><td class="memItemLeft" align="right" valign="top">geometry_msgs::Quaternion&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#afbef336bbcb2c1100f1e01e10a7beee6">goal_orientation</a></td></tr>
<tr class="memdesc:afbef336bbcb2c1100f1e01e10a7beee6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Goal orientation on map.  <a href="#afbef336bbcb2c1100f1e01e10a7beee6">More...</a><br /></td></tr>
<tr class="separator:afbef336bbcb2c1100f1e01e10a7beee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ace2e48e2ae1119c2d4d0ae2ea25b8"><td class="memItemLeft" align="right" valign="top">geometry_msgs::Twist&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#ad9ace2e48e2ae1119c2d4d0ae2ea25b8">velocity_to_publish</a></td></tr>
<tr class="memdesc:ad9ace2e48e2ae1119c2d4d0ae2ea25b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Velocity sent to robot driver.  <a href="#ad9ace2e48e2ae1119c2d4d0ae2ea25b8">More...</a><br /></td></tr>
<tr class="separator:ad9ace2e48e2ae1119c2d4d0ae2ea25b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12fa92d7da4d3dad3d9962e706c7eb60"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a12fa92d7da4d3dad3d9962e706c7eb60">tolerance_angle</a></td></tr>
<tr class="separator:a12fa92d7da4d3dad3d9962e706c7eb60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e58fbe5f78a53ae55c2fc5ff2e690d0"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="path__follower_8cpp.html#a7e58fbe5f78a53ae55c2fc5ff2e690d0">tolerance_dist</a></td></tr>
<tr class="separator:a7e58fbe5f78a53ae55c2fc5ff2e690d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a381fc6065d560c219bdf0733ccd3ba13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a381fc6065d560c219bdf0733ccd3ba13">&#9670;&nbsp;</a></span>angle_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool angle_check </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>goal_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tfScalar&#160;</td>
          <td class="paramname"><em>yaw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00213">213</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The node subscribes to a TF topic, and gets the current position of the robot as a base_link. It receives from the callback the goal position, and publishes the required position as a geometry_msgs::Twist to reach that position. The path follower computes the angle difference between the goal position and the robot orientation. The robot then rotates left or right accordingly, until it is on the same line as the goal orientation. At that moment, the robot moves forward. All "robot movements" are considered as published veolcities as geometry_msgs::Twist messages. </p>
<p>Current position of robot</p>
<p>Current orientation of robot in quaternion </p>

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00050">50</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="aa9a42b10b0895a8dea5f7a3e53622445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9a42b10b0895a8dea5f7a3e53622445">&#9670;&nbsp;</a></span>path_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void path_callback </td>
          <td>(</td>
          <td class="paramtype">const nav_msgs::Path::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>received_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Path Callback Callback function for the path follower. The node subscribes to the nav_msgs::Path published by rtabmap. These messages provide the node with the goal position and orientation to be achived when in GO_TO_GOAL MODE. The callback is used to initialize the two gobal variables goal_position and goal_orientation used in the </p>

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00188">188</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="a6580d4219bb711f9f65ecdc5ae43a7b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6580d4219bb711f9f65ecdc5ae43a7b4">&#9670;&nbsp;</a></span>proximity_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool proximity_check </td>
          <td>(</td>
          <td class="paramtype">geometry_msgs::Point&#160;</td>
          <td class="paramname"><em>goal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tf::Point&#160;</td>
          <td class="paramname"><em>current</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Proximity Check The function checks whether the robot is close enough to the target position and returns a bool. It takes as input and uses the xy coordinates of the goal position and current positions. If the robot is close enough, it returns a true, otherwise returns a false. </p>

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00205">205</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a06bc50440cb7aad0ef28a930499574c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06bc50440cb7aad0ef28a930499574c5">&#9670;&nbsp;</a></span>current_path</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;geometry_msgs::PoseStamped&gt; current_path</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00031">31</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="afbef336bbcb2c1100f1e01e10a7beee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbef336bbcb2c1100f1e01e10a7beee6">&#9670;&nbsp;</a></span>goal_orientation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::Quaternion goal_orientation</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Goal orientation on map. </p>

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00036">36</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="a1dd788339a5b3696b0f6273eda3136fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dd788339a5b3696b0f6273eda3136fc">&#9670;&nbsp;</a></span>goal_position</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::Point goal_position</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Goal position on map. </p>

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00034">34</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="afd300c5785c540c1370de4c45066f345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd300c5785c540c1370de4c45066f345">&#9670;&nbsp;</a></span>it</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;geometry_msgs::PoseStamped&gt;::iterator it</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00032">32</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="a12fa92d7da4d3dad3d9962e706c7eb60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12fa92d7da4d3dad3d9962e706c7eb60">&#9670;&nbsp;</a></span>tolerance_angle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float tolerance_angle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00040">40</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="a7e58fbe5f78a53ae55c2fc5ff2e690d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e58fbe5f78a53ae55c2fc5ff2e690d0">&#9670;&nbsp;</a></span>tolerance_dist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float tolerance_dist</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00040">40</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
<a id="ad9ace2e48e2ae1119c2d4d0ae2ea25b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ace2e48e2ae1119c2d4d0ae2ea25b8">&#9670;&nbsp;</a></span>velocity_to_publish</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::Twist velocity_to_publish</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Velocity sent to robot driver. </p>

<p class="definition">Definition at line <a class="el" href="path__follower_8cpp_source.html#l00038">38</a> of file <a class="el" href="path__follower_8cpp_source.html">path_follower.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
